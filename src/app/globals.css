/* Tailwind CSS directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Base configuration */
    --radius: 0.5rem;

    /* CSS VARIABLES - NO HARDCODED VALUES */
    /* All values are set dynamically by ThemeContext/Settings */
    /* These are just placeholders - real values come from Settings Appearance */
    --background: 0 0% 0%;
    --foreground: 0 0% 100%;
    --card: 0 0% 0%;
    --card-foreground: 0 0% 100%;
    --primary: 0 0% 50%;
    --primary-foreground: 0 0% 100%;
    --secondary: 0 0% 50%;
    --secondary-foreground: 0 0% 100%;
    --accent: 0 0% 50%;
    --accent-foreground: 0 0% 100%;
    --muted: 0 0% 25%;
    --muted-foreground: 0 0% 75%;
    --border: 0 0% 50%;
    --input: 0 0% 50%;
    --ring: 0 0% 50%;
    --destructive: 0 100% 50%;
    --destructive-foreground: 0 0% 100%;
    --system-text: 0 0% 88%;
    --popover: var(--card);
    --popover-foreground: var(--card-foreground);

    /* Additional colors - also controlled by settings */
    --success: 0 100% 50%;
    --warning: 60 100% 50%;
    --info: 200 100% 50%;
    --code-background: 0 0% 10%;
    --code-border: 0 0% 20%;
  }

  /* Global theme enforcement - ensure all elements respect theme variables */
  /* Removed global border-color override - let components define their own borders */

  body {
    background-color: hsl(var(--background)) !important;
    color: hsl(var(--foreground)) !important;
  }

  /* Ensure all text elements use theme colors */
  h1, h2, h3, h4, h5, h6, p, span, div, label {
    color: inherit !important;
  }

  /* Fix icon color inheritance - ensure all SVG icons inherit proper colors */
  svg, .lucide, [data-lucide] {
    color: inherit !important;
  }

  /* Fix button text and icon colors specifically */
  button, .button, [role="button"] {
    color: hsl(var(--foreground)) !important;
  }

  button svg, .button svg, [role="button"] svg {
    color: inherit !important;
  }

  /* Fix dropdown and select text colors */
  select, .select, [role="combobox"] {
    color: hsl(var(--foreground)) !important;
  }

  /* Fix ALL text elements to use proper theme colors */
  input, textarea, label, span, div, p, h1, h2, h3, h4, h5, h6 {
    color: inherit !important;
  }

  /* Force specific problematic elements */
  .text-foreground {
    color: hsl(var(--foreground)) !important;
  }

  /* Fix muted text to be more visible */
  .text-muted-foreground {
    color: hsl(var(--muted-foreground)) !important;
  }

  /* Ensure placeholder text is visible */
  ::placeholder {
    color: hsl(var(--muted-foreground)) !important;
    opacity: 0.8 !important;
  }

  /* Fix tab navigation text */
  [role="tab"], .tab, .nav-item {
    color: hsl(var(--foreground)) !important;
  }

  /* Fix form labels and inputs */
  .form-label, .input-label, fieldset legend {
    color: hsl(var(--foreground)) !important;
  }

  /* Removed destructive global button styling that broke the interface */
}

@layer base {
  * {
    /* Removed global border - was causing thick borders everywhere */
  }

  /* Hide scrollbars but keep scrolling functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Smooth scrolling for chat messages */
  .chat-messages {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch; /* iOS momentum scrolling */
  }

  /* Enhanced smooth scrolling for all scrollable elements */
  .scrollable {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Smooth scrolling for the entire document */
  html {
    scroll-behavior: smooth;
  }

  /* Optimize font rendering */
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Clean base styling - no forced decorations */
  html {
    background: var(--background);
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
    margin: 0;
    padding: 0;
  }

  #__next {
    background: var(--background);
    width: 100%;
    height: 100%;
    position: relative;
    margin: 0;
  }

  /* Force main app container background */
  .h-screen.w-full {
    background: var(--background) !important;
    color: var(--foreground) !important;
  }

  /* Force all main containers */
  html, body, #__next, [class*="h-screen"], [class*="w-full"] {
    background-color: var(--background) !important;
    color: var(--foreground) !important;
  }

  /* Force rounded corners on all elements */
  * {
    box-sizing: border-box !important;
  }

  /* Simplified styling using CSS variables */
  .card {
    background: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 16px !important;
    word-wrap: break-word !important; /* Ensure text wrapping */
    overflow-wrap: break-word !important; /* Ensure text wrapping */
  }

  /* Dialog content styling */
  [data-radix-dialog-content] {
    background: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 8px !important;
  }

  /* Allow buttons to use their own styling */

  /* Exception for toggle switches - allow custom styling */
  button[role="switch"] {
    background: unset !important;
    border: unset !important;
    border-radius: 9999px !important; /* Keep it fully rounded */
  }

  /* Specific styling for enabled toggle switches */
  button[role="switch"][aria-checked="true"] {
    background: hsl(var(--primary)) !important; /* Use theme primary */
    box-shadow: 0 4px 14px 0 hsl(var(--primary) / 0.3) !important;
    border: 2px solid hsl(var(--primary) / 0.5) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  button[role="switch"][aria-checked="true"]:hover {
    background: hsl(var(--primary) / 0.8) !important; /* Darker on hover */
    box-shadow: 0 6px 20px 0 hsl(var(--primary) / 0.4) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  button[role="switch"][aria-checked="false"] {
    background: hsl(var(--muted-foreground)) !important; /* Use theme muted */
    border: 2px solid hsl(var(--muted-foreground) / 0.3) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  /* Input fields with much better visibility */
  input, textarea, select {
    background: hsl(var(--muted)) !important; /* Use theme muted */
    color: hsl(var(--foreground)) !important;
    border: 2px solid hsl(var(--border)) !important;
    border-radius: 6px !important;
  }

  /* Focus states for input fields */
  input:focus, textarea:focus, select:focus {
    background: hsl(var(--card)) !important; /* Use theme card on focus */
    border-color: hsl(var(--ring)) !important;
    outline: none !important;
    box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2) !important;
  }

  /* Hover states for input fields */
  input:hover, textarea:hover, select:hover {
    background: hsl(var(--muted) / 0.8) !important;
    border-color: hsl(var(--accent)) !important;
  }

  /* Settings window input fields - brighter background for better visibility */
  .settings-input input,
  .settings-input textarea,
  .settings-input select,
  .settings-input [data-radix-select-trigger] {
    background: #3a3a4e !important; /* Brighter than previous #2a2a3e */
    color: var(--foreground) !important;
    border: none !important;
    border-radius: 8px !important;
  }

  /* Auto-resize textarea using CSS field-sizing */
  textarea {
    field-sizing: content !important; /* Native CSS auto-resize */
    resize: none !important; /* Disable manual resize */
    overflow-y: auto !important; /* Show scrollbar when needed */
  }

  /* Specifically target action menu buttons to remove borders */
  .space-y-1 button,
  [class*="space-y"] button,
  button[class*="w-full"],
  button[class*="justify-start"] {
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }

  /* Remove global button hover override to allow component-specific hover styles */

  /* Enhanced animations for thinking indicator */
  @keyframes thinking-bounce {
    0%, 80%, 100% {
      transform: scale(0);
      opacity: 0.5;
    }
    40% {
      transform: scale(1);
      opacity: 1;
    }
  }

  .thinking-dot {
    animation: thinking-bounce 1.4s infinite ease-in-out both;
  }

  .thinking-dot:nth-child(1) { animation-delay: -0.32s; }
  .thinking-dot:nth-child(2) { animation-delay: -0.16s; }
  .thinking-dot:nth-child(3) { animation-delay: 0s; }

  /* Scroll to bottom button animations */
  @keyframes scroll-button-bounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-2px);
    }
  }

  .scroll-to-bottom-button {
    animation: scroll-button-bounce 2s infinite ease-in-out;
  }

  .scroll-to-bottom-button:hover {
    animation: none;
    transform: scale(1.05);
  }

  /* Chat bubble colors use Tailwind classes - no overrides needed */

  /* Message bubble specific styling - override card defaults */
  .user-message,
  .bg-primary {
    background: hsl(var(--primary) / 0.8) !important; /* Use theme primary with opacity */
    color: hsl(var(--primary-foreground)) !important;
    border-radius: 16px !important; /* Match main app */
    border: none !important; /* Remove all borders */
    word-wrap: break-word !important; /* Fix text overflow */
    overflow-wrap: break-word !important; /* Fix text overflow */
    max-width: 100% !important; /* Ensure proper containment */
  }

  .assistant-message,
  .bg-secondary {
    background: hsl(var(--muted) / 0.7) !important; /* Use theme muted with opacity */
    color: hsl(var(--foreground)) !important; /* Use theme foreground */
    border-radius: 16px !important; /* Match main app */
    border: none !important; /* Remove all borders */
    word-wrap: break-word !important; /* Fix text overflow */
    overflow-wrap: break-word !important; /* Fix text overflow */
    max-width: 100% !important; /* Ensure proper containment */
  }

  /* Ensure card content inherits colors and proper text wrapping */
  .user-message .card-content,
  .user-message [data-radix-card-content],
  .bg-primary .card-content,
  .bg-primary [data-radix-card-content] {
    background: transparent !important;
    color: white !important;
    border: none !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: pre-wrap !important; /* Preserve formatting while allowing wrapping */
  }

  .assistant-message .card-content,
  .assistant-message [data-radix-card-content],
  .bg-secondary .card-content,
  .bg-secondary [data-radix-card-content] {
    background: transparent !important;
    color: white !important;
    border: none !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: pre-wrap !important; /* Preserve formatting while allowing wrapping */
  }

  /* Prevent scaling during drag operations */
  .dragging * {
    transform: none !important;
    zoom: normal !important;
    scale: 1 !important;
    -webkit-transform: none !important;
    -moz-transform: none !important;
    -ms-transform: none !important;
  }
}

@layer components {

  /* Ensure dropdown menus and inputs have solid backgrounds */
  [data-radix-select-content],
  [data-radix-popover-content] {
    background-color: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 6px !important;
  }

  /* Ensure input fields have solid backgrounds */
  input, textarea, select {
    background: var(--muted) !important;
    color: var(--foreground) !important;
  }

  /* Solid backgrounds for dropdown items */
  [data-radix-select-item],
  .popover-content > * {
    background-color: var(--muted) !important;
    color: var(--foreground) !important;
  }

  [data-radix-select-item]:hover,
  [data-radix-select-item][data-highlighted] {
    background-color: var(--accent) !important;
  }

  /* Hide scrollbars while maintaining functionality */
  .hide-scrollbar {
    /* Firefox */
    scrollbar-width: none !important;
    /* Safari and Chrome */
    -ms-overflow-style: none !important;
    /* Ensure scrolling still works */
    overflow-y: auto;
    overflow-x: hidden;
    /* Smooth scrolling performance */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  .hide-scrollbar::-webkit-scrollbar-track {
    display: none !important;
  }

  .hide-scrollbar::-webkit-scrollbar-thumb {
    display: none !important;
  }

  /* Optimize scrolling for overlay windows */
  .overlay-scroll {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    /* Remove any conflicting properties */
    will-change: auto;
    transform: none;
    contain: none;
  }



  /* Force hide all scrollbars in chat areas */
  .chat-messages {
    scrollbar-width: none !important;
    -ms-overflow-style: none !important;
  }

  .chat-messages::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  /* Custom themed scrollbar for chat window */
  .custom-scrollbar {
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: var(--border) var(--muted);
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: var(--muted);
    border-radius: 4px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    border: 1px solid var(--muted);
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--accent);
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:active {
    background: var(--primary);
  }

  .custom-scrollbar::-webkit-scrollbar-corner {
    background: var(--muted);
  }

  /* Apply custom scrollbar globally to all scrollable elements */
  * {
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: var(--border) var(--muted);
  }

  *::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  *::-webkit-scrollbar-track {
    background: var(--muted);
    border-radius: 4px;
  }

  *::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    border: 1px solid var(--muted);
  }

  *::-webkit-scrollbar-thumb:hover {
    background: var(--accent);
  }

  *::-webkit-scrollbar-corner {
    background: var(--muted);
  }


}
