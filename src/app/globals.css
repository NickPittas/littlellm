/* Tailwind CSS directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Static CSS variables - no dynamic theming */
    --radius: 0.5rem;

    /* VS Code theme colors - Direct hex values */
    --background: #181829;
    --foreground: #d4d4d4;
    --card: #181829;
    --card-foreground: #ffffff;
    --primary: #569cd6;
    --primary-foreground: #ffffff;
    --secondary: #4fc1ff;
    --secondary-foreground: #adadad;
    --accent: rgba(86, 156, 214, 0.811);
    --accent-foreground: #ffffff;
    --muted: #211f32;
    --muted-foreground: #9ca3af;
    --border: #3b3b68;
    --input: #949494;
    --ring: #569cd6;
    --destructive: #f44747;
    --destructive-foreground: #ffffff;
    --popover: #8f8f8f;
    --popover-foreground: #d4d4d4;

    /* Additional VS Code colors for enhanced theming */
    --success: #4ec9b0;
    --warning: #dcdcaa;
    --info: #4fc1ff;
    --code-background: #1e1e1e;
    --code-border: #464647;
  }
}

@layer base {
  * {
    /* Removed global border - was causing thick borders everywhere */
  }

  /* Hide scrollbars but keep scrolling functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Smooth scrolling for chat messages */
  .chat-messages {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch; /* iOS momentum scrolling */
  }

  /* Enhanced smooth scrolling for all scrollable elements */
  .scrollable {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Smooth scrolling for the entire document */
  html {
    scroll-behavior: smooth;
  }

  /* Optimize font rendering */
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Big rounded corners with no borders - simplified */
  html {
    background: var(--background) !important;
    margin: 0 !important;
    padding: 0 !important;
    border-radius: 32px !important;
    overflow: hidden !important;
    width: 100% !important;
    height: 100% !important;
    position: relative !important;
    border: 0px solid transparent !important;
    outline: none !important;
    box-shadow: none !important;
  }

  body {
    background-color: var(--background) !important;
    color: var(--foreground) !important;
    border-radius: 32px !important;
    overflow: hidden !important;
    margin: 0 !important;
    padding: 0 !important;
    border: 0px solid transparent !important;
    outline: none !important;
    box-shadow: none !important;
  }

  #__next {
    background: var(--background) !important;
    border-radius: 32px !important;
    overflow: hidden !important;
    width: 100% !important;
    height: auto !important;
    position: relative !important;
    min-height: 0 !important;
    border: 0px solid transparent !important;
    outline: none !important;
    box-shadow: none !important;
  }

  /* Force main app container background */
  .h-screen.w-full {
    background: var(--background) !important;
    color: var(--foreground) !important;
  }

  /* Force all main containers */
  html, body, #__next, [class*="h-screen"], [class*="w-full"] {
    background-color: var(--background) !important;
    color: var(--foreground) !important;
  }

  /* Force rounded corners on all elements */
  * {
    box-sizing: border-box !important;
  }

  /* Simplified styling using CSS variables */
  .card {
    background: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 16px !important;
    word-wrap: break-word !important; /* Ensure text wrapping */
    overflow-wrap: break-word !important; /* Ensure text wrapping */
  }

  /* Dialog content styling */
  [data-radix-dialog-content] {
    background: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 8px !important;
  }

  /* Force buttons and inputs to be solid with better contrast */
  button:not([role="switch"]) {
    background: var(--muted) !important;
    color: var(--foreground) !important;
    border: none !important;
    border-radius: 6px !important;
  }

  /* Exception for toggle switches - allow custom styling */
  button[role="switch"] {
    background: unset !important;
    border: unset !important;
    border-radius: 9999px !important; /* Keep it fully rounded */
  }

  /* Specific styling for enabled toggle switches */
  button[role="switch"][aria-checked="true"] {
    background: #22c55e !important; /* Bright green */
    box-shadow: 0 4px 14px 0 rgba(34, 197, 94, 0.3) !important;
    border: 2px solid rgba(34, 197, 94, 0.5) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  button[role="switch"][aria-checked="true"]:hover {
    background: #16a34a !important; /* Darker green on hover */
    box-shadow: 0 6px 20px 0 rgba(34, 197, 94, 0.4) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  button[role="switch"][aria-checked="false"] {
    background: #6b7280 !important; /* Gray when disabled */
    border: 2px solid rgba(107, 114, 128, 0.3) !important;
    border-radius: 9999px !important; /* Fully rounded */
  }

  /* Input fields with much better visibility */
  input, textarea, select {
    background: #1a1a2e !important; /* Much darker than background */
    color: var(--foreground) !important;
    border: 2px solid var(--border) !important;
    border-radius: 6px !important;
  }

  /* Focus states for input fields */
  input:focus, textarea:focus, select:focus {
    background: #16213e !important; /* Even darker on focus */
    border-color: var(--ring) !important;
    outline: none !important;
    box-shadow: 0 0 0 2px rgba(86, 156, 214, 0.2) !important;
  }

  /* Hover states for input fields */
  input:hover, textarea:hover, select:hover {
    background: #1e1e3f !important;
    border-color: var(--accent) !important;
  }

  /* Settings window input fields - brighter background for better visibility */
  .settings-input input,
  .settings-input textarea,
  .settings-input select,
  .settings-input [data-radix-select-trigger] {
    background: #3a3a4e !important; /* Brighter than previous #2a2a3e */
    color: var(--foreground) !important;
    border: none !important;
    border-radius: 8px !important;
  }

  /* Auto-resize textarea using CSS field-sizing */
  textarea {
    field-sizing: content !important; /* Native CSS auto-resize */
    resize: none !important; /* Disable manual resize */
    overflow-y: auto !important; /* Show scrollbar when needed */
  }

  /* Specifically target action menu buttons to remove borders */
  .space-y-1 button,
  [class*="space-y"] button,
  button[class*="w-full"],
  button[class*="justify-start"] {
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }

  button:hover {
    background: var(--accent) !important;
  }

  /* Enhanced animations for thinking indicator */
  @keyframes thinking-bounce {
    0%, 80%, 100% {
      transform: scale(0);
      opacity: 0.5;
    }
    40% {
      transform: scale(1);
      opacity: 1;
    }
  }

  .thinking-dot {
    animation: thinking-bounce 1.4s infinite ease-in-out both;
  }

  .thinking-dot:nth-child(1) { animation-delay: -0.32s; }
  .thinking-dot:nth-child(2) { animation-delay: -0.16s; }
  .thinking-dot:nth-child(3) { animation-delay: 0s; }

  /* Scroll to bottom button animations */
  @keyframes scroll-button-bounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-2px);
    }
  }

  .scroll-to-bottom-button {
    animation: scroll-button-bounce 2s infinite ease-in-out;
  }

  .scroll-to-bottom-button:hover {
    animation: none;
    transform: scale(1.05);
  }

  /* Chat bubble colors use Tailwind classes - no overrides needed */

  /* Message bubble specific styling - override card defaults */
  .user-message,
  .bg-primary {
    background: rgba(86, 156, 214, 0.8) !important; /* More subtle blue */
    color: var(--primary-foreground) !important;
    border-radius: 16px !important; /* Match main app */
    border: none !important; /* Remove all borders */
    word-wrap: break-word !important; /* Fix text overflow */
    overflow-wrap: break-word !important; /* Fix text overflow */
    max-width: 100% !important; /* Ensure proper containment */
  }

  .assistant-message,
  .bg-secondary {
    background: rgba(45, 42, 65, 0.7) !important; /* Lighter/more muted color between background and user message */
    color: #d4d4d4 !important; /* Use foreground color for better readability */
    border-radius: 16px !important; /* Match main app */
    border: none !important; /* Remove all borders */
    word-wrap: break-word !important; /* Fix text overflow */
    overflow-wrap: break-word !important; /* Fix text overflow */
    max-width: 100% !important; /* Ensure proper containment */
  }

  /* Ensure card content inherits colors and proper text wrapping */
  .user-message .card-content,
  .user-message [data-radix-card-content],
  .bg-primary .card-content,
  .bg-primary [data-radix-card-content] {
    background: transparent !important;
    color: white !important;
    border: none !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: pre-wrap !important; /* Preserve formatting while allowing wrapping */
  }

  .assistant-message .card-content,
  .assistant-message [data-radix-card-content],
  .bg-secondary .card-content,
  .bg-secondary [data-radix-card-content] {
    background: transparent !important;
    color: white !important;
    border: none !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    white-space: pre-wrap !important; /* Preserve formatting while allowing wrapping */
  }

  /* Prevent scaling during drag operations */
  .dragging * {
    transform: none !important;
    zoom: normal !important;
    scale: 1 !important;
    -webkit-transform: none !important;
    -moz-transform: none !important;
    -ms-transform: none !important;
  }
}

@layer components {

  /* Ensure dropdown menus and inputs have solid backgrounds */
  [data-radix-select-content],
  [data-radix-popover-content] {
    background-color: var(--card) !important;
    border: none !important;
    color: var(--card-foreground) !important;
    border-radius: 6px !important;
  }

  /* Ensure input fields have solid backgrounds */
  input, textarea, select {
    background: var(--muted) !important;
    color: var(--foreground) !important;
  }

  /* Solid backgrounds for dropdown items */
  [data-radix-select-item],
  .popover-content > * {
    background-color: var(--muted) !important;
    color: var(--foreground) !important;
  }

  [data-radix-select-item]:hover,
  [data-radix-select-item][data-highlighted] {
    background-color: var(--accent) !important;
  }

  /* Hide scrollbars while maintaining functionality */
  .hide-scrollbar {
    /* Firefox */
    scrollbar-width: none !important;
    /* Safari and Chrome */
    -ms-overflow-style: none !important;
    /* Ensure scrolling still works */
    overflow-y: auto;
    overflow-x: hidden;
    /* Smooth scrolling performance */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  .hide-scrollbar::-webkit-scrollbar-track {
    display: none !important;
  }

  .hide-scrollbar::-webkit-scrollbar-thumb {
    display: none !important;
  }

  /* Optimize scrolling for overlay windows */
  .overlay-scroll {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    /* Remove any conflicting properties */
    will-change: auto;
    transform: none;
    contain: none;
  }



  /* Force hide all scrollbars in chat areas */
  .chat-messages {
    scrollbar-width: none !important;
    -ms-overflow-style: none !important;
  }

  .chat-messages::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  /* Custom themed scrollbar for chat window */
  .custom-scrollbar {
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: var(--border) var(--muted);
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: var(--muted);
    border-radius: 4px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    border: 1px solid var(--muted);
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--accent);
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:active {
    background: var(--primary);
  }

  .custom-scrollbar::-webkit-scrollbar-corner {
    background: var(--muted);
  }

  /* Apply custom scrollbar globally to all scrollable elements */
  * {
    /* Firefox */
    scrollbar-width: thin;
    scrollbar-color: var(--border) var(--muted);
  }

  *::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  *::-webkit-scrollbar-track {
    background: var(--muted);
    border-radius: 4px;
  }

  *::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
    border: 1px solid var(--muted);
  }

  *::-webkit-scrollbar-thumb:hover {
    background: var(--accent);
  }

  *::-webkit-scrollbar-corner {
    background: var(--muted);
  }
}
