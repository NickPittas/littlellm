[ ] NAME:Current Task List DESCRIPTION:Root task for conversation __NEW_AGENT__
-[ ] NAME:Research and Install Document Parsing Libraries DESCRIPTION:Research and install appropriate npm packages for parsing various document formats (Excel, CSV, HTML, ICS, JSON, ODS, RTF, XML, XLS, XLSX, PPT, PPTX, DOC, DOCX). Evaluate libraries like mammoth (for Word docs), xlsx (for Excel), csv-parser, and others. Install the selected libraries and update package.json.
-[ ] NAME:Implement Document Parser Service DESCRIPTION:Create a comprehensive DocumentParserService that can extract text content from various document formats. This service should handle Excel files, CSV files, HTML files, ICS calendar files, JSON files, ODS spreadsheets, RTF documents, XML files, and PowerPoint presentations. Each parser should extract meaningful text content that can be passed to LLM models.
-[ ] NAME:Update File Type Support Configuration DESCRIPTION:Update the file input accept attributes and file type validation across all components (ChatInterface, BottomToolbarNew, AttachmentPreview) to include the new supported document formats. Update the provider-specific file type support matrices to indicate which formats are supported natively vs. require text extraction.
-[ ] NAME:Integrate Document Parser with Chat Service DESCRIPTION:Modify the chatService.ts extractTextFromFile method to use the new DocumentParserService for supported document formats. Update the file processing logic in all provider implementations to check if a file type is natively supported by the model, and if not, use the document parser to extract text content before sending to the model.
-[ ] NAME:Update Provider-Specific File Handling DESCRIPTION:Review and update each LLM provider's file handling logic (OpenAI, Anthropic, Mistral, Ollama, etc.) to properly route document files. For providers that support certain document types natively, pass them through unchanged. For providers that don't support specific formats, ensure they use the parsed text content from the DocumentParserService.
-[ ] NAME:Enhance File Attachment UI DESCRIPTION:Update the AttachmentPreview component to show appropriate icons and previews for the new document types. Add visual indicators to show whether a file will be processed natively by the selected model or converted to text. Update file size and type validation messages to reflect the expanded supported formats.
-[ ] NAME:Add Error Handling and Fallbacks DESCRIPTION:Implement comprehensive error handling for document parsing failures. Add fallback mechanisms when document parsing fails (e.g., provide file metadata instead of content). Create user-friendly error messages for unsupported file types or parsing failures. Add logging for document processing success/failure rates.
-[ ] NAME:Create Tests and Documentation DESCRIPTION:Write unit tests for the new link parsing, code block detection, and document parsing functionality. Create integration tests for file attachment processing with various document types. Update documentation to reflect the new supported file formats and capabilities. Add examples of how different document types are processed.